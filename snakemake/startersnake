from sys import argv

rule all:
	input:
		"config.yaml",
		"startersnake.log",
		"temp.log"
	
rule write_config:
	output:
		"config.yaml"
	params:
		ref = argv[4],
		db = argv[6],
		fastq = argv[8],
		scripts_path = argv[10],
		database_prot = argv[12]
	shell:
		"""
		python3 scripts/add_configs.py {params.ref} {params.db} {params.fastq} {params.scripts_path} {params.database_prot}
		"""

rule run_configurated_pipeline:
	input:
		"config.yaml" 
	log:
		"startersnake.log"
	shell:
		"""
		sleep 3
		
		nice -16 snakemake -s identsnake --cores 90 --use-conda --resources mem_mb=800000 --latency-wait 3
		"""
